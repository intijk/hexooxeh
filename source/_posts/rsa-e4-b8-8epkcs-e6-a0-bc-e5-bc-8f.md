---
title: RSA与PKCS格式
id: 494
categories:
  - 其它
date: 2011-07-03 11:51:52
tags:
---

RSA是目前网上最常用的公钥加密算法，下面的讲述假定你懂RSA。
公私钥的使用方式如下：
1.目标机（Target）是要登录的机器。
2.终端机（Terminal）是你用来登录目标机的计算机。
你用你的手机（Terminal）登录到一个超级计算机集群（Target）就是一个登录行为。
私钥放在目标机，公钥放在终端机。
登录的时候，把密码用终端机上的公钥进行加密，发送给目标机，目标机用私钥解开以后，验证密码的正确性，决定是否让你登录。
这个过程中如果有人侦听（被动攻击），它能够获得加密后的数据，但解不开，就得不到你的密码。

这里讲讲在ssh-keygen的时候发生了什么。
如果用ssh-keygen命令，则会产生两个文件，一个是id_rsa（私钥)，一个是id_rsa.pub（公钥）,仔细观察这两个文件的内容，发现它们并不是两个数值，也就是我们期待的私钥数值d和公钥数值e，而是一串字符串，这是为什么呢？因为对于密钥格式，有一个叫做PKCS的标准，ssh-keygen产生的格式是pkcs8标准，在OpenSSH的代码中，有这么一个函数：
static void do_convert_to_pkcs8(Key *k);
这个Key *k就保存了数值密钥的内容，do_convert_topkcs8将它转换成了字符串格式。
关于PKCS8标准，可以参见[RFC5208](http://tools.ietf.org/html/rfc5208)