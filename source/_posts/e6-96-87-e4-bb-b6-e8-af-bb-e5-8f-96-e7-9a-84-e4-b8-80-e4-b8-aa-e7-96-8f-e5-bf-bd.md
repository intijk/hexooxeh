---
title: 文件读取的一个疏忽
id: 394
categories:
  - 其它
date: 2011-02-25 08:54:31
tags:
---

在python写的后台抓取引擎的日志文件中，我用一个临时文件存储日志，当一个抓取周期发生错误以后，认为本轮的日志是“有用的”，将其连接到正式日志文件之后，但发现正式的日志文件体积增长特别快。分析之后，我发现原因如下:

[python]
logTmp.truncate(0)
print '后续的日志'
[/python]

我以为把一个文件截断成0长度之后文件指针会自动归零，原来它没有，而是保持原来的值，后面的写入造成了文件开始处的“空块”，整个日志文件体积的增长速度和斐波那契数列一样快 ... 

这就是没有好好学C语言基础文件操作的结果... 关于文件空块的内容书里还曾提到过的。